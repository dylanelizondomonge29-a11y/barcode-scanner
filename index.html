<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>Escaneo de Código de Barras</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<script src="https://unpkg.com/html5-qrcode@2.3.8/minified/html5-qrcode.min.js"></script>
<style>
#reader {
  width: 80%;
  max-width: 360px;
  height: 300px;
  margin: 20px auto;
  border: 1px solid #ccc;
  background: #000;
}
</style>
</head>
<body>
<div id="reader"></div>
<button id="startBtn">▶️ Activar cámara</button>

<script>
let scanner = null;

document.getElementById("startBtn").addEventListener("click", () => {
  if(scanner) return;
  const readerWidth = document.getElementById("reader").clientWidth;
  scanner = new Html5Qrcode("reader");
  scanner.start(
    { facingMode: "environment" },
    { fps: 10, qrbox: { width: readerWidth, height: 250 } },
    (decodedText) => {
      console.log("Código leído:", decodedText);
      scanner.stop().then(() => console.log("Cámara detenida")).catch(console.error);
    },
    (error) => { /* ignorar errores de frame */ }
  ).catch(err => console.error("Error iniciando cámara:", err));
});
</script>
</body>
</html>
